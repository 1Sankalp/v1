"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./app/lib/auth.config.ts":
/*!********************************!*\
  !*** ./app/lib/auth.config.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authConfig: () => (/* binding */ authConfig)\n/* harmony export */ });\n/* harmony import */ var _auth_core_providers_github__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @auth/core/providers/github */ \"(middleware)/./node_modules/@auth/core/providers/github.js\");\n/* harmony import */ var _auth_core_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @auth/core/providers/google */ \"(middleware)/./node_modules/@auth/core/providers/google.js\");\n/* harmony import */ var _auth_core_providers_credentials__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @auth/core/providers/credentials */ \"(middleware)/./node_modules/@auth/core/providers/credentials.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @supabase/supabase-js */ \"(middleware)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bcryptjs */ \"(middleware)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var resend__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! resend */ \"(middleware)/./node_modules/resend/dist/index.mjs\");\n\n\n\n\n\n\n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_6__.createClient)(\"https://jznlgabssuvtmkikdixz.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\nconst resend = new resend__WEBPACK_IMPORTED_MODULE_5__.Resend(process.env.RESEND_API_KEY);\nconst authConfig = {\n    pages: {\n        signIn: \"/login\",\n        verifyRequest: \"/verify-request\",\n        error: \"/auth/error\"\n    },\n    providers: [\n        (0,_auth_core_providers_github__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            clientId: process.env.GITHUB_ID,\n            clientSecret: process.env.GITHUB_SECRET\n        }),\n        (0,_auth_core_providers_google__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            clientId: process.env.GOOGLE_ID,\n            clientSecret: process.env.GOOGLE_SECRET\n        }),\n        (0,_auth_core_providers_credentials__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                },\n                username: {\n                    label: \"Username\",\n                    type: \"text\"\n                },\n                isSignup: {\n                    label: \"Is Signup\",\n                    type: \"boolean\"\n                }\n            },\n            async authorize (credentials) {\n                const { email, password, username, isSignup } = credentials;\n                if (!email || !password) {\n                    throw new Error(\"Invalid credentials\");\n                }\n                if (isSignup && !username) {\n                    throw new Error(\"Username is required for signup\");\n                }\n                try {\n                    if (isSignup) {\n                        // Check if user already exists\n                        const { data: existingUser } = await supabase.from(\"users\").select(\"id\").or(`email.eq.${email.toLowerCase()},username.eq.${username.toLowerCase()}`).single();\n                        if (existingUser) {\n                            throw new Error(\"User already exists\");\n                        }\n                        const hashedPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_3__[\"default\"].hash(password, 10);\n                        const userId = crypto__WEBPACK_IMPORTED_MODULE_4___default().randomUUID();\n                        // Create new user with minimal fields\n                        const { data: newUser, error: createError } = await supabase.from(\"users\").insert({\n                            id: userId,\n                            email: email.toLowerCase(),\n                            username: username.toLowerCase(),\n                            hashed_password: hashedPassword,\n                            emailVerified: null\n                        }).select('id, email, username, \"emailVerified\"').single();\n                        if (createError) {\n                            console.error(\"Create user error:\", createError);\n                            throw new Error(createError.message);\n                        }\n                        // Generate verification token\n                        const verificationToken = crypto__WEBPACK_IMPORTED_MODULE_4___default().randomUUID();\n                        // Store verification token\n                        const { error: tokenError } = await supabase.from(\"verification_tokens\").insert({\n                            identifier: email.toLowerCase(),\n                            token: verificationToken,\n                            expires: new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 hours\n                        });\n                        if (tokenError) {\n                            console.error(\"Token creation error:\", tokenError);\n                        // Don't throw here, still allow user creation\n                        } else {\n                            // Send verification email\n                            try {\n                                const verificationUrl = `${process.env.NEXTAUTH_URL}/api/auth/verify-email?token=${verificationToken}`;\n                                await resend.emails.send({\n                                    from: \"Superfolio <onboarding@superfolio.me>\",\n                                    to: email.toLowerCase(),\n                                    subject: \"Verify your Superfolio email\",\n                                    html: `\n                    <h1>Welcome to Superfolio!</h1>\n                    <p>Thank you for joining us. Please verify your email address by clicking the link below:</p>\n                    <a href=\"${verificationUrl}\">Verify Email Address</a>\n                    <p>Your profile will be available at: superfolio.me/${username}</p>\n                    <p>If the button above doesn't work, copy and paste this URL into your browser:</p>\n                    <p>${verificationUrl}</p>\n                  `\n                                });\n                                console.log(\"Verification email sent to:\", email);\n                            } catch (emailError) {\n                                console.error(\"Error sending verification email:\", emailError);\n                            // Don't throw here, still allow user creation\n                            }\n                        }\n                        return newUser;\n                    }\n                    // Handle sign in\n                    const { data: user, error } = await supabase.from(\"users\").select('id, email, username, hashed_password, \"emailVerified\"').eq(\"email\", email.toLowerCase()).single();\n                    if (error || !user) {\n                        throw new Error(\"User not found\");\n                    }\n                    const isValidPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_3__[\"default\"].compare(password, user.hashed_password || \"\");\n                    if (!isValidPassword) {\n                        throw new Error(\"Invalid password\");\n                    }\n                    // Return user without password\n                    const { hashed_password: _, ...userWithoutPassword } = user;\n                    return userWithoutPassword;\n                } catch (error) {\n                    console.error(\"Auth error:\", error);\n                    throw error;\n                }\n            }\n        })\n    ],\n    callbacks: {\n        async jwt ({ token, user, trigger, session }) {\n            if (trigger === \"update\" && session) {\n                return {\n                    ...token,\n                    ...session.user\n                };\n            }\n            if (user) {\n                // Ensure we have all required fields\n                token.id = user.id;\n                token.username = user.username?.toLowerCase();\n                token.emailVerified = user.emailVerified;\n            }\n            // Ensure username is always lowercase if it exists\n            if (token.username) {\n                token.username = token.username.toLowerCase();\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token && session.user) {\n                session.user.id = token.id;\n                session.user.username = token.username;\n                session.user.emailVerified = token.emailVerified;\n            }\n            return session;\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YnBhY2s6Ly9fTl9FLy4vYXBwL2xpYi9hdXRoLmNvbmZpZy50cz9hYTBiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEF1dGhDb25maWcgfSBmcm9tIFwibmV4dC1hdXRoXCJcbmltcG9ydCBHaXRIdWIgZnJvbSBcIkBhdXRoL2NvcmUvcHJvdmlkZXJzL2dpdGh1YlwiXG5pbXBvcnQgR29vZ2xlIGZyb20gXCJAYXV0aC9jb3JlL3Byb3ZpZGVycy9nb29nbGVcIlxuaW1wb3J0IENyZWRlbnRpYWxzIGZyb20gXCJAYXV0aC9jb3JlL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJ1xuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nXG5pbXBvcnQgeyBSZXNlbmQgfSBmcm9tICdyZXNlbmQnXG5cbmNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxuICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIVxuKVxuXG5jb25zdCByZXNlbmQgPSBuZXcgUmVzZW5kKHByb2Nlc3MuZW52LlJFU0VORF9BUElfS0VZKVxuXG5leHBvcnQgY29uc3QgYXV0aENvbmZpZyA9IHtcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46ICcvbG9naW4nLFxuICAgIHZlcmlmeVJlcXVlc3Q6ICcvdmVyaWZ5LXJlcXVlc3QnLFxuICAgIGVycm9yOiAnL2F1dGgvZXJyb3InXG4gIH0sXG4gIHByb3ZpZGVyczogW1xuICAgIEdpdEh1Yih7XG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR0lUSFVCX0lEISxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR0lUSFVCX1NFQ1JFVCEsXG4gICAgfSksXG4gICAgR29vZ2xlKHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5HT09HTEVfSUQhLFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfU0VDUkVUISxcbiAgICB9KSxcbiAgICBDcmVkZW50aWFscyh7XG4gICAgICBjcmVkZW50aWFsczoge1xuICAgICAgICBlbWFpbDogeyBsYWJlbDogXCJFbWFpbFwiLCB0eXBlOiBcImVtYWlsXCIgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgbGFiZWw6IFwiUGFzc3dvcmRcIiwgdHlwZTogXCJwYXNzd29yZFwiIH0sXG4gICAgICAgIHVzZXJuYW1lOiB7IGxhYmVsOiBcIlVzZXJuYW1lXCIsIHR5cGU6IFwidGV4dFwiIH0sXG4gICAgICAgIGlzU2lnbnVwOiB7IGxhYmVsOiBcIklzIFNpZ251cFwiLCB0eXBlOiBcImJvb2xlYW5cIiB9XG4gICAgICB9LFxuICAgICAgYXN5bmMgYXV0aG9yaXplKGNyZWRlbnRpYWxzKSB7XG4gICAgICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkLCB1c2VybmFtZSwgaXNTaWdudXAgfSA9IGNyZWRlbnRpYWxzIGFzIGFueTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNyZWRlbnRpYWxzJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNTaWdudXAgJiYgIXVzZXJuYW1lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VybmFtZSBpcyByZXF1aXJlZCBmb3Igc2lnbnVwJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmIChpc1NpZ251cCkge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBhbHJlYWR5IGV4aXN0c1xuICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1VzZXIgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAgICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgICAgICAgLm9yKGBlbWFpbC5lcS4ke2VtYWlsLnRvTG93ZXJDYXNlKCl9LHVzZXJuYW1lLmVxLiR7dXNlcm5hbWUudG9Mb3dlckNhc2UoKX1gKVxuICAgICAgICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgICAgICAgIGlmIChleGlzdGluZ1VzZXIpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIGFscmVhZHkgZXhpc3RzJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgdXNlciB3aXRoIG1pbmltYWwgZmllbGRzXG4gICAgICAgICAgICBjb25zdCB7IGRhdGE6IG5ld1VzZXIsIGVycm9yOiBjcmVhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgICAgICBoYXNoZWRfcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IG51bGxcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnNlbGVjdCgnaWQsIGVtYWlsLCB1c2VybmFtZSwgXCJlbWFpbFZlcmlmaWVkXCInKVxuICAgICAgICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgICAgICAgIGlmIChjcmVhdGVFcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDcmVhdGUgdXNlciBlcnJvcjonLCBjcmVhdGVFcnJvcik7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihjcmVhdGVFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gR2VuZXJhdGUgdmVyaWZpY2F0aW9uIHRva2VuXG4gICAgICAgICAgICBjb25zdCB2ZXJpZmljYXRpb25Ub2tlbiA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0b3JlIHZlcmlmaWNhdGlvbiB0b2tlblxuICAgICAgICAgICAgY29uc3QgeyBlcnJvcjogdG9rZW5FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgICAgLmZyb20oJ3ZlcmlmaWNhdGlvbl90b2tlbnMnKVxuICAgICAgICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICAgICAgICBpZGVudGlmaWVyOiBlbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIHRva2VuOiB2ZXJpZmljYXRpb25Ub2tlbixcbiAgICAgICAgICAgICAgICBleHBpcmVzOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgMjQgKiA2MCAqIDYwICogMTAwMCkgLy8gMjQgaG91cnNcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh0b2tlbkVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rva2VuIGNyZWF0aW9uIGVycm9yOicsIHRva2VuRXJyb3IpO1xuICAgICAgICAgICAgICAvLyBEb24ndCB0aHJvdyBoZXJlLCBzdGlsbCBhbGxvdyB1c2VyIGNyZWF0aW9uXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBTZW5kIHZlcmlmaWNhdGlvbiBlbWFpbFxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblVybCA9IGAke3Byb2Nlc3MuZW52Lk5FWFRBVVRIX1VSTH0vYXBpL2F1dGgvdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dmVyaWZpY2F0aW9uVG9rZW59YDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhd2FpdCByZXNlbmQuZW1haWxzLnNlbmQoe1xuICAgICAgICAgICAgICAgICAgZnJvbTogJ1N1cGVyZm9saW8gPG9uYm9hcmRpbmdAc3VwZXJmb2xpby5tZT4nLFxuICAgICAgICAgICAgICAgICAgdG86IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgICAgICBzdWJqZWN0OiAnVmVyaWZ5IHlvdXIgU3VwZXJmb2xpbyBlbWFpbCcsXG4gICAgICAgICAgICAgICAgICBodG1sOiBgXG4gICAgICAgICAgICAgICAgICAgIDxoMT5XZWxjb21lIHRvIFN1cGVyZm9saW8hPC9oMT5cbiAgICAgICAgICAgICAgICAgICAgPHA+VGhhbmsgeW91IGZvciBqb2luaW5nIHVzLiBQbGVhc2UgdmVyaWZ5IHlvdXIgZW1haWwgYWRkcmVzcyBieSBjbGlja2luZyB0aGUgbGluayBiZWxvdzo8L3A+XG4gICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIke3ZlcmlmaWNhdGlvblVybH1cIj5WZXJpZnkgRW1haWwgQWRkcmVzczwvYT5cbiAgICAgICAgICAgICAgICAgICAgPHA+WW91ciBwcm9maWxlIHdpbGwgYmUgYXZhaWxhYmxlIGF0OiBzdXBlcmZvbGlvLm1lLyR7dXNlcm5hbWV9PC9wPlxuICAgICAgICAgICAgICAgICAgICA8cD5JZiB0aGUgYnV0dG9uIGFib3ZlIGRvZXNuJ3Qgd29yaywgY29weSBhbmQgcGFzdGUgdGhpcyBVUkwgaW50byB5b3VyIGJyb3dzZXI6PC9wPlxuICAgICAgICAgICAgICAgICAgICA8cD4ke3ZlcmlmaWNhdGlvblVybH08L3A+XG4gICAgICAgICAgICAgICAgICBgXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1ZlcmlmaWNhdGlvbiBlbWFpbCBzZW50IHRvOicsIGVtYWlsKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZW1haWxFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgdmVyaWZpY2F0aW9uIGVtYWlsOicsIGVtYWlsRXJyb3IpO1xuICAgICAgICAgICAgICAgIC8vIERvbid0IHRocm93IGhlcmUsIHN0aWxsIGFsbG93IHVzZXIgY3JlYXRpb25cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbmV3VXNlcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBIYW5kbGUgc2lnbiBpblxuICAgICAgICAgIGNvbnN0IHsgZGF0YTogdXNlciwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgICAgICAgLnNlbGVjdCgnaWQsIGVtYWlsLCB1c2VybmFtZSwgaGFzaGVkX3Bhc3N3b3JkLCBcImVtYWlsVmVyaWZpZWRcIicpXG4gICAgICAgICAgICAuZXEoJ2VtYWlsJywgZW1haWwudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICAgIGlmIChlcnJvciB8fCAhdXNlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGlzVmFsaWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLmhhc2hlZF9wYXNzd29yZCB8fCAnJyk7XG4gICAgICAgICAgaWYgKCFpc1ZhbGlkUGFzc3dvcmQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXNzd29yZCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFJldHVybiB1c2VyIHdpdGhvdXQgcGFzc3dvcmRcbiAgICAgICAgICBjb25zdCB7IGhhc2hlZF9wYXNzd29yZDogXywgLi4udXNlcldpdGhvdXRQYXNzd29yZCB9ID0gdXNlcjtcbiAgICAgICAgICByZXR1cm4gdXNlcldpdGhvdXRQYXNzd29yZDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGggZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgXSxcbiAgY2FsbGJhY2tzOiB7XG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIHRyaWdnZXIsIHNlc3Npb24gfSkge1xuICAgICAgaWYgKHRyaWdnZXIgPT09IFwidXBkYXRlXCIgJiYgc2Vzc2lvbikge1xuICAgICAgICByZXR1cm4geyAuLi50b2tlbiwgLi4uc2Vzc2lvbi51c2VyIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgLy8gRW5zdXJlIHdlIGhhdmUgYWxsIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgICB0b2tlbi5pZCA9IHVzZXIuaWQ7XG4gICAgICAgIHRva2VuLnVzZXJuYW1lID0gdXNlci51c2VybmFtZT8udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgdG9rZW4uZW1haWxWZXJpZmllZCA9IHVzZXIuZW1haWxWZXJpZmllZDtcbiAgICAgIH1cblxuICAgICAgLy8gRW5zdXJlIHVzZXJuYW1lIGlzIGFsd2F5cyBsb3dlcmNhc2UgaWYgaXQgZXhpc3RzXG4gICAgICBpZiAodG9rZW4udXNlcm5hbWUpIHtcbiAgICAgICAgdG9rZW4udXNlcm5hbWUgPSB0b2tlbi51c2VybmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdG9rZW47XG4gICAgfSxcbiAgICBhc3luYyBzZXNzaW9uKHsgc2Vzc2lvbiwgdG9rZW4gfSkge1xuICAgICAgaWYgKHRva2VuICYmIHNlc3Npb24udXNlcikge1xuICAgICAgICBzZXNzaW9uLnVzZXIuaWQgPSB0b2tlbi5pZCBhcyBzdHJpbmc7XG4gICAgICAgIHNlc3Npb24udXNlci51c2VybmFtZSA9IHRva2VuLnVzZXJuYW1lIGFzIHN0cmluZztcbiAgICAgICAgc2Vzc2lvbi51c2VyLmVtYWlsVmVyaWZpZWQgPSB0b2tlbi5lbWFpbFZlcmlmaWVkIGFzIERhdGUgfCBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfVxuICB9XG59IHNhdGlzZmllcyBOZXh0QXV0aENvbmZpZyAiXSwibmFtZXMiOlsiR2l0SHViIiwiR29vZ2xlIiwiQ3JlZGVudGlhbHMiLCJjcmVhdGVDbGllbnQiLCJiY3J5cHQiLCJjcnlwdG8iLCJSZXNlbmQiLCJzdXBhYmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwicmVzZW5kIiwiUkVTRU5EX0FQSV9LRVkiLCJhdXRoQ29uZmlnIiwicGFnZXMiLCJzaWduSW4iLCJ2ZXJpZnlSZXF1ZXN0IiwiZXJyb3IiLCJwcm92aWRlcnMiLCJjbGllbnRJZCIsIkdJVEhVQl9JRCIsImNsaWVudFNlY3JldCIsIkdJVEhVQl9TRUNSRVQiLCJHT09HTEVfSUQiLCJHT09HTEVfU0VDUkVUIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwidXNlcm5hbWUiLCJpc1NpZ251cCIsImF1dGhvcml6ZSIsIkVycm9yIiwiZGF0YSIsImV4aXN0aW5nVXNlciIsImZyb20iLCJzZWxlY3QiLCJvciIsInRvTG93ZXJDYXNlIiwic2luZ2xlIiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwidXNlcklkIiwicmFuZG9tVVVJRCIsIm5ld1VzZXIiLCJjcmVhdGVFcnJvciIsImluc2VydCIsImlkIiwiaGFzaGVkX3Bhc3N3b3JkIiwiZW1haWxWZXJpZmllZCIsImNvbnNvbGUiLCJtZXNzYWdlIiwidmVyaWZpY2F0aW9uVG9rZW4iLCJ0b2tlbkVycm9yIiwiaWRlbnRpZmllciIsInRva2VuIiwiZXhwaXJlcyIsIkRhdGUiLCJub3ciLCJ2ZXJpZmljYXRpb25VcmwiLCJORVhUQVVUSF9VUkwiLCJlbWFpbHMiLCJzZW5kIiwidG8iLCJzdWJqZWN0IiwiaHRtbCIsImxvZyIsImVtYWlsRXJyb3IiLCJ1c2VyIiwiZXEiLCJpc1ZhbGlkUGFzc3dvcmQiLCJjb21wYXJlIiwiXyIsInVzZXJXaXRob3V0UGFzc3dvcmQiLCJjYWxsYmFja3MiLCJqd3QiLCJ0cmlnZ2VyIiwic2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./app/lib/auth.config.ts\n");

/***/ })

});